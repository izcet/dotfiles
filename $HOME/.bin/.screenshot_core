#!/bin/bash

# because fuck the guys who maintain gnome-screenshot
# https://cialu.net/how-to-change-default-gnome-screenshot-savings-folder/
# https://bugzilla.gnome.org/show_bug.cgi?id=699642#c15

# -- -- -- -- -- -- variables -- -- -- -- -- -- # 
DATE="$(date "+%Y-%b-%d-%a")"
TIME="$(date "+%H:%M:%S")"
PREFIX=""  # for optional future prefix
OUTDIR="${HOME}/linux-screenshots/${DATE}"
FLAG=""  # for optional debug flags


# -- -- -- -- -- -- err check -- -- -- -- -- -- # 
if [ "$#" -ne "3" ] ; then
    # !exec ?file -flag +pref
    echo "Usage: $0 \"<0|1>\" \"--flags\" <\"\"|prefix>"
    exit 0
fi


# -- -- -- -- -- -- teh logic -- -- -- -- -- -- # 
FLAG="${FLAG}${2}"

if [ "${1}" -eq "1" ] ; then
    PREFIX="${PREFIX}${3}"
    FILE="${TIME}-${PREFIX}.png"

    FLAG="${FLAG} --file ${OUTDIR}/${FILE}"
    
    mkdir -p "${OUTDIR}"
fi

DEBUG="/tmp/debug-${TIME}.txt"
gnome-screenshot $FLAG 2>&1 >> "${DEBUG}"
cat "${DEBUG}"
